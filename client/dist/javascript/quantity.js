!function(s){function e(t){return t.parent().find("input[name='x:visibleQuantity']").data("link")}function r(t){return t.parent().find("input[name='x:visibleQuantity']").data("code")}function u(t){return t.parent().find("input[name='x:visibleQuantity']").data("id")}function c(t){return t.parent().parent().find("input[name='x:visibleQuantity']")}function l(t){t.parent().find("button.increase, button.reduced").attr("disabled",!0).addClass("hidden")}function p(t){var n=t.parents("form[id^=FoxyStripePurchaseForm_PurchaseForm_]"),i=n.attr("id");n.find("fieldset").html('<h4 id="'+i+'_unavailableText">Currently Out of Stock</h4>'),n.find("input[name=action_x\\:submit]").remove()}function d(t){t.parent().parent().parent().find(".fs-add-to-cart-button").attr("disabled",!0)}function o(){m.data("fetch",1)}function f(t,n,i,a,r){var e,u,d,o={code:t,value:n,id:a,isAjax:1};s.ajax({type:"get",url:(u=o,d="?",-1!=(e=i).indexOf("?")&&(d="&"),e+d+s.param(u))}).done(function(t){var n,i,a=JSON.parse(t);if(a.hasOwnProperty("limit")){n=r,i=a.limit,n.parent().find("input[name='x:visibleQuantity']").data("limit",i);var e=c(r);a.limit<e.val()&&e.val(a.limit),0==a.limit?p(r):1==a.limit?l(r):a.limit==a.quantity?r.parent().find("button.increase").attr("disabled",!0):r.parent().find("button.increase").attr("disabled",!1)}r.parent().parent().parent().parent().find("input[name='quantity']").val(a.quantityGenerated),m.data("fetch",0),r.parent().parent().parent().find(".fs-add-to-cart-button").attr("disabled",!1)}).fail(function(t){404==t.status&&"I can't handle sub-URLs on class SilverStripe\\Forms\\FormRequestHandler."==t.responseText?p(r):console.log("Error: "+t.responseText)})}var m=s("input[name='x:visibleQuantity']");s("input[name='quantity']");s(document).on("click","button.increase",function(t){var n=c(s(this)),i=n.val(),a=parseInt(i)+1;o(),d(s(this)),f(r(s(this)),a,e(s(this)),u(s(this)),s(this)),n.val(a)}),s(document).on("click","button.reduced",function(t){m.data("fetch",1);var n=c(s(this)),i=n.val(),a=parseInt(i)-1;1<i&&(o(),d(s(this)),f(r(s(this)),a,e(s(this)),u(s(this)),s(this)),n.val(a))}),s(document).ready(function(){s("button.increase").each(function(){var t=s(this).parent().find("input[name='x:visibleQuantity']").data("limit");1==t?l(s(this)):0==t&&p(s(this))})})}(jQuery);var FC=FC||{};FC.onLoad=function(n){return function(){function t(){FC.client.request("https://"+FC.settings.storedomain+"/cart?output=json").done(function(t){jQuery.each(t.items,function(t,n){var i=""===n.parent_code?n.code:n.parent_code,a=!!n.hasOwnProperty("url")&&n.url;if(a){var e=a.split("?"),r="";1<e.length&&(a=e[0],r="&"+e[1]),jQuery.ajax({url:a+"AddToCartForm/field/x:visibleQuantity/newvalue?code="+i+"&id="+n.id+"&value="+n.quantity+"&isAjax=1"+r,dataType:"json",success:function(t){n.quantity==t.quantity?FC.client.event("cart-quantity-updated").trigger({id:n.id,quantity:t.quantity}):setTimeout(function(){FC.cart.updateItemQuantity({id:n.id,quantity:t.quantity})},150)}})}})})}void 0!==n&&n.apply(this,arguments),FC.client.on("cart-item-quantity-update.done",function(){t()}),FC.client.on("cart-submit.done",function(){t()})}}(FC.onLoad);